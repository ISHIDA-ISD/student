<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple SNS</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage.js"></script>
</head>
<body>
    <h1>Simple SNS</h1>
    <input type="file" id="imageUpload" />
    <button onclick="uploadImage()">Upload Image</button>
    <div id="posts"></div>

    <script>
        const firebaseConfig = {
            apiKey: "YOUR_ACTUAL_API_KEY",
            authDomain: "YOUR_ACTUAL_AUTH_DOMAIN",
            projectId: "YOUR_ACTUAL_PROJECT_ID",
            storageBucket: "YOUR_ACTUAL_STORAGE_BUCKET",
            messagingSenderId: "YOUR_ACTUAL_MESSAGING_SENDER_ID",
            appId: "YOUR_ACTUAL_APP_ID"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const storage = firebase.storage();

        async function uploadImage() {
            const file = document.getElementById('imageUpload').files[0];
            const storageRef = storage.ref();
            const fileRef = storageRef.child(file.name);
            await fileRef.put(file);
            const fileUrl = await fileRef.getDownloadURL();

            await db.collection('posts').add({
                imageUrl: fileUrl,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            });

            loadPosts();
        }

        async function loadPosts() {
            const postsDiv = document.getElementById('posts');
            postsDiv.innerHTML = '';
            const snapshot = await db.collection('posts').orderBy('createdAt', 'desc').get();
            snapshot.forEach(doc => {
                const post = doc.data();
                const postDiv = document.createElement('div');
                postDiv.innerHTML = `<img src="${post.imageUrl}" width="200" /><br>`;
                postsDiv.appendChild(postDiv);
            });
        }

        loadPosts();
    </script>
</body>
</html>
